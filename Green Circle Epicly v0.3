setscreen ("graphics:800;700")

var chars : array char of boolean
var dead : boolean := false
var x, y, speed_upgrade, row, col : int

const midx := maxx div 2
const midy := maxy div 2

x := midx
y := midy
speed_upgrade := 0
row := midy
col := midx

proc upgrades (var col : int, var row : int, size : int, colouring : int)

    drawfillbox (row, col, row + size, col + size, colouring)

    if row <= x and x <= row + size and y <= col + size and col <= y then
        speed_upgrade := 1
        col := black
    end if

end upgrades

loop

    Input.KeyDown (chars)

    %Circle movement(has to be multiple if statements)

    if chars (KEY_UP_ARROW) or chars ('w') then
        y := y + 1 + speed_upgrade
    end if

    if chars (KEY_RIGHT_ARROW) or chars ('d') then
        x := x + 1 + speed_upgrade
    end if

    if chars (KEY_LEFT_ARROW) or chars ('a') then
        x := x - 1 - speed_upgrade
    end if

    if chars (KEY_DOWN_ARROW) or chars ('s') then
        y := y - 1 - speed_upgrade
    end if

    %Sets boundaries for the circle

    if x >= 800 then
        x := x - 4 - speed_upgrade
    end if

    if y >= 700 then
        y := y - 4 - speed_upgrade
    end if

    if y <= 0 then
        y := y + 4 + speed_upgrade
    end if

    if x <= 0 then
        x := x + 4 + speed_upgrade
    end if

    %Exits program

    if chars (KEY_ESC) then
        exit
    end if

    %Draws stuff

    drawfillbox (0, 0, maxx, maxy, black) %Background
    drawfilloval (x, y, 4, 4, brightgreen) %Circle
    upgrades (col, row, 20, brightgreen)

    View.Update
    delay (4)

end loop
